classDiagram
    %% Configuration Classes
    class CudaConfig {
        +cuda_visible_devices
        +cuda_device_order
    }
    class RayConfig {
        +object_store_memory
        +include_dashboard
        +ignore_reinit_error
    }
    class DatasetConfig {
        +path
        +text_col
        +limit
    }
    class VLLMConfig {
        +model
        +tensor_parallel_size
        +gpu_memory_utilization
        +max_tokens
    }
    class InferenceConfig {
        +batch_size
        +concurrency
        +num_gpus
    }

    %% Pipeline & Operators
    class RayDatasetLike {
        +map()
        +limit()
        +map_batches()
    }

    class DatasetOp {
        +__call__()
    }

    class RayDataPipeline {
        +ops
        +add()
        +run()
    }

    class MapRowsOp {
        +fn
        +__call__()
    }

    class LimitOp {
        +limit
        +__call__()
    }

    class ActorPoolInferenceOp {
        +predictor_cls
        +predictor_kwargs
        +batch_size
        +concurrency
        +num_gpus
        +__call__()
    }

    %% Task & Predictor
    class SentimentTask {
        +text_col
        +prompt_col
        +review_out_col
        +prediction_col
        +raw_output_col
        +instruction
        +build_prompt_row()
    }

    class SentimentPredictor {
        +__init__()
        +__call__()
    }

    %% Relationships
    RayDataPipeline o-- DatasetOp
    DatasetOp <|.. MapRowsOp
    DatasetOp <|.. LimitOp
    DatasetOp <|.. ActorPoolInferenceOp
    ActorPoolInferenceOp ..> SentimentPredictor
    SentimentTask ..> MapRowsOp